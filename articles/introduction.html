<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to condvis2 â€¢ condvis2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to condvis2">
<meta property="og:description" content="condvis2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">condvis2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Keras.html">Exploring keras models with condvis2</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to condvis2</a>
    </li>
    <li>
      <a href="../articles/mclust.html">Exploring model-based clustering with condvis2</a>
    </li>
    <li>
      <a href="../articles/mlr.html">mlr fits and condvis2</a>
    </li>
    <li>
      <a href="../articles/parsnip.html">parsnip fits and condvis2</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbhurley/condvis2/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to condvis2</h1>
                        <h4 class="author">Catherine B. Hurley</h4>
            
            <h4 class="date">2021-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbhurley/condvis2/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>This vignette is an introduction to condvis2. This package constructs shiny-based interactive visualisations of prediction models.</p>
<div id="ozone-data" class="section level2">
<h2 class="hasAnchor">
<a href="#ozone-data" class="anchor"></a>Ozone data</h2>
<p>We will use the airquality data built in to R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ozone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></code></pre></div>
<p>The first fit we consider uses Wind only to predict ozone. Here we construct the fit and plot the results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span>, data<span class="op">=</span><span class="va">ozone</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span>, data<span class="op">=</span><span class="va">ozone</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">21</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">175</span><span class="op">)</span><span class="op">)</span>
<span class="va">wind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ozone</span><span class="op">$</span><span class="va">Wind</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ozone</span><span class="op">$</span><span class="va">Wind</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">30</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">wind</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Wind<span class="op">=</span><span class="va">wind</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></p>
<p>If we add in a second predictor, we can either move to plotting the surface, or plot how the fit relates to one predictor, for a fixed value of another.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span><span class="op">+</span><span class="va">Solar.R</span>, data<span class="op">=</span><span class="va">ozone</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">ozone</span><span class="op">$</span><span class="va">Solar.R</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.5</span>,<span class="fl">.75</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="va">Solar.R</span> <span class="op">&lt;=</span> <span class="va">s</span><span class="op">+</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">Solar.R</span> <span class="op">&gt;=</span> <span class="va">s</span><span class="op">-</span><span class="fl">20</span><span class="op">)</span>,
     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">21</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">175</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Solar.R="</span>,<span class="va">s</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">wind</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Wind<span class="op">=</span><span class="va">wind</span>, Solar.R<span class="op">=</span> <span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-3-1.png" width="700.8" style="display: block; margin: auto;"></p>
<p>Notice in the above plots we are only plotting observations where Solar.R values are close to the value used for prediction.</p>
<p>These plots can be constructed interactively in <code>condvis2</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cbhurley.github.io/condvis2">condvis2</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/condvis.html">condvis</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="va">fit2</span>,sectionvars<span class="op">=</span><span class="st">"Wind"</span>, conditionvars<span class="op">=</span><span class="st">"Solar.R"</span><span class="op">)</span></code></pre></div>
<p>This gives the following display:</p>
<p><img src="ozone.png" width="100%" style="display: block; margin: auto;"></p>
<ul>
<li>The histogram on the right shows the values for Solar.R.</li>
<li>The selected value of Solar.R is 207. By clicking on the histogram, you can change this selection.</li>
<li>The main display (on the left) shows the predicted values of Ozone, varying Wind and fixing Solar.R at <span class="math inline">\(f_2 =207\)</span>.</li>
<li>Only observations which have Solar.R values near 207 are shown,i.e., observations whose <span class="math inline">\(d_i = |x_{i,2} - f_2|&lt;1\)</span>, where Solar.R values are measured in standard units.</li>
<li>The nearness required can be increased or decreased from 1 by moving the Similarity Threshold slider.</li>
<li>Also, point colours fade to reflect the distances <span class="math inline">\(d_i\)</span>, so points very near or on the section are dark blue, with colour fading as distance increases.</li>
<li>You can exchange the roles of Solar.R and Wind by choosing Solar.R in the <code>Choose a sectionvar</code> menu.</li>
</ul>
<p>In this way we can see how well the curve fits to observations in its section.</p>
<p>If we include another predictor in the fit</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span><span class="op">+</span><span class="va">Solar.R</span><span class="op">+</span><span class="va">Temp</span>, data<span class="op">=</span><span class="va">ozone</span><span class="op">)</span></code></pre></div>
<p>and invoke condvis</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/condvis.html">condvis</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="va">fit3</span>, sectionvars<span class="op">=</span><span class="st">"Wind"</span>, conditionvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Temp"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>the result is shown in the screenshot below.</p>
<p><img src="ozone1.png" width="100%" style="display: block; margin: auto;"></p>
<ul>
<li>The plot on the right shows the values for Solar.R and Temp. By clicking on this plot, you can change the selected values.</li>
<li>The main display (on the left) shows the predicted values of Ozone, varying Wind and fixing Solar.R and Temp.</li>
<li>Only observations which have Solar.R and Temp values near the pink cross are shown.The distance is calculated as <span class="math display">\[ d_i = max(|x_{i,2} - f_2|, |x_{i,3} - f_3|)&lt;1,\]</span> where <span class="math inline">\(f_2\)</span> and <span class="math inline">\(f_3\)</span> are the fixed values of Solar.R and Temp, and <span class="math inline">\((x_{i,2}, x_{i,3})\)</span> are the observation coordinates (all standardised).</li>
<li>Again, point colours fade to reflect the distances <span class="math inline">\(d_i\)</span>.</li>
<li>The plot on the right shows all the observations, but points near the pink cross (those visible in the main plot) are slightly larger with a dark outline.</li>
</ul>
</div>
<div id="two-section-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#two-section-variables" class="anchor"></a>Two section variables</h2>
<p>You can also pick a second section variable, to see how the fitted surface looks as a function of two variables, while the third is modified interactively.</p>
<p><img src="ozone4.png" width="100%" style="display: block; margin: auto;"> The image shows fitted surface levels as a function of two predictors. The points shown are near the fixed conditioning values. For an image plot, the point colour represents the observed response, coloured in the same way as the fitted surface. Here we convey the distance of an observations condition values to the fixed condition levels by size. You will see some points in the main display whose colour does not match the image colour, for example, the two darker points around Wind=10, with low Solar.R. As the points are large, they are near the conditioning values which are poorly fit.</p>
<p>There is very little data at low Temp, and none of these observations have a Wind value below 7. So the steep incline at the left hand side of the main plot is not supported by the data. Prediction in this area is extrapolation.</p>
<p><img src="ozone3.png" width="100%" style="display: block; margin: auto;"></p>
<p>Alternatively, the relationship between Ozone and (Wind, Solar.R) for fixed Temp may be displayed as a 3-d surface. The points near the selected value of Temp are dark blue, lightening in colour as the distance increases. The residual sizes are shown via line segments.</p>
</div>
<div id="comparing-two-fits" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-two-fits" class="anchor"></a>Comparing two fits</h2>
<p>We could fit a second fit to the same data and compare the results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span>
<span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span><span class="op">+</span><span class="va">Solar.R</span><span class="op">+</span><span class="va">Temp</span>, data<span class="op">=</span><span class="va">ozone</span><span class="op">)</span>
<span class="fu"><a href="../reference/condvis.html">condvis</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>loess<span class="op">=</span><span class="va">fit3</span>,svm<span class="op">=</span><span class="va">fit4</span><span class="op">)</span>, sectionvars<span class="op">=</span><span class="st">"Wind"</span>, conditionvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Temp"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ozone5.png" width="100%" style="display: block; margin: auto;"></p>
<p>We see big differences between the fits, especially for low Wind.</p>
<p>Note: condvis uses CVpredict to extract predictions from fitted models. By default CVpredict uses predict, but there are customised versions of CVpredict for many fit types. (See the help page.)</p>
</div>
<div id="confidence-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#confidence-intervals" class="anchor"></a>Confidence intervals</h2>
<p>Condvis2 supports confidence intervals, for fits that offer them.</p>
<p>Use</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">~</span><span class="va">Wind</span><span class="op">+</span><span class="va">Solar.R</span><span class="op">+</span><span class="va">Temp</span>, data<span class="op">=</span><span class="va">ozone</span><span class="op">)</span>
<span class="fu"><a href="../reference/condvis.html">condvis</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="va">fit5</span>, 
        sectionvars<span class="op">=</span><span class="st">"Wind"</span>, conditionvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Temp"</span><span class="op">)</span>, predictArgs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pinterval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The loess fit does not provide confidence intervals but it does offer standard errors, which can be used for confidence bounds:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitu</span> <span class="op">&lt;-</span> <span class="va">fit3</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">fitu</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"upper"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">fitu</span><span class="op">)</span><span class="op">)</span>

<span class="va">CVpredict.upper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">newdata</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">newdata</span>, se<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
  <span class="va">p</span><span class="op">$</span><span class="va">fit</span><span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">p</span><span class="op">$</span><span class="va">se.fit</span>
<span class="op">}</span>

<span class="va">fitl</span> <span class="op">&lt;-</span> <span class="va">fit3</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">fitl</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lower"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">fitu</span><span class="op">)</span><span class="op">)</span>

<span class="va">CVpredict.lower</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">newdata</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">newdata</span>, se<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
  <span class="va">p</span><span class="op">$</span><span class="va">fit</span><span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">p</span><span class="op">$</span><span class="va">se.fit</span>
<span class="op">}</span>

<span class="fu"><a href="../reference/condvis.html">condvis</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>loess<span class="op">=</span><span class="va">fit3</span>,lower<span class="op">=</span><span class="va">fitl</span>,upper<span class="op">=</span><span class="va">fitu</span><span class="op">)</span>, 
        sectionvars<span class="op">=</span><span class="st">"Wind"</span>, conditionvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Temp"</span><span class="op">)</span>, 
        linecols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>,<span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ozone6.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="tour-controls" class="section level2">
<h2 class="hasAnchor">
<a href="#tour-controls" class="anchor"></a>Tour controls</h2>
<p>As the conditioning dimension increases, it might be easier to view sections that are automatically chosen. The tour controls offer various controls.</p>
<ul>
<li>The simplest method chooses random observations in conditioning space to form the sections.</li>
<li>Click on the arrow below <code>Tour Step</code> to watch.</li>
<li>You can increase the number of random points via the <code>Tour Length</code> slider.</li>
<li>If you want a smoother appearance to the tour, increase <code>Interp steps</code> from 0.</li>
</ul>
</div>
<div id="example-a-density-estimate" class="section level2">
<h2 class="hasAnchor">
<a href="#example-a-density-estimate" class="anchor"></a>Example : A density estimate</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.mvstat.net/mvksa/">ks</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="va">irisf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ks/man/kde.html">kde</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>

<span class="fu"><a href="../reference/condvis.html">condvis</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>kde<span class="op">=</span><span class="va">irisf</span><span class="op">)</span>, 
        sectionvars<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span><span class="op">)</span>, 
        conditionvars<span class="op">=</span> <span class="st">"Petal.Length"</span>, density<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<p>The result is shown in the screenshot below. It shows the estimated density of two variables conditional on the third.</p>
<p><img src="iris.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Catherine B. Hurley, Mark Oâ€™Connell, Katarina Domijan. (2021) Interactive slice visualization for exploring machine learning models. arXiv 2101.06986.</p>
<p>Mark Oâ€™Connell, Catherine Hurley, Katarina Domijan. (2017) Conditional Visualization for Statistical Models: An Introduction to the condvis Package in R. Journal of Statistical Software 81(5) 1â€“20.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Catherine Hurley, Mark OConnell, Katarina Domijan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
